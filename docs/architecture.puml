@startuml
!define RECTANGLE class

skinparam componentStyle rectangle
skinparam monochrome true
skinparam shadowing false

package "Video Analytics Platform" {
    [Video Source Manager] as VSM
    [Analytics Engine] as AE
    [Streaming Server] as SS
    [API Server] as API
    [MQTT Client] as MQTT
}

cloud "Video Sources" {
    [Local Files] as LF
    [RTSP Cameras] as RTSP
}

database "InfluxDB" as DB
[Mosquitto Broker] as MB
[Grafana] as GF

VSM --> LF : reads
VSM --> RTSP : connects
VSM --> AE : sends frames
AE --> SS : processed frames
SS --> API : stream data
API --> VSM : control
API --> AE : control
API --> SS : control
AE --> MQTT : analytics events
MQTT --> MB : publishes
MB --> GF : metrics
DB --> GF : time series
AE --> DB : stores results

note right of VSM
  Manages multiple video sources
  Handles frame acquisition
end note

note right of AE
  YOLOv5n object detection
  Real-time processing
end note

note right of SS
  GStreamer pipelines
  RTSP streaming
end note

note right of API
  FastAPI REST endpoints
  System control
end note

@enduml 